
<project name="nightly" default="package">

	<property name="xpidl" value="c:\\mozilla\\moztools\\bin\\xpidl.exe"/>
	
	<target name="components">
		<apply executable="${xpidl}" dir="${basedir}/components" dest="${basedir}/components">
			<mapper type="glob" from="*.idl" to="*.xpt"/>
			<fileset dir="${basedir}/components" includes="*.idl"/>
			<arg line="-m typelib -w -v"/>
			<arg value="-I"/>
			<arg value="c:\\mozilla\\mozilla\\xpcom\\base"/>
			<arg value="-I"/>
			<arg value="c:\\mozilla\\mozilla\\uriloader\\base"/>
			<arg value="-I"/>
			<arg value="c:\\mozilla\\mozilla\\netwerk\\base\\public"/>
			<arg value="-I"/>
			<arg value="c:\\mozilla\\mozilla\\xpcom\\io"/>
		</apply>
	</target>
	
	<target name="package" depends="components">
		<zip destfile="${basedir}/${ant.project.name}.xpi">
			<fileset dir="${basedir}">
				<include name="**/*"/>
				<exclude name="components/*.idl"/>
				<exclude name="*.xpi"/>
				<exclude name="build.xml"/>
				<exclude name=".*"/>
			</fileset>
		</zip>
	</target>
	
</project>
